node{
  stage("CheckOutCodeGit"){
  sh "echo running nodejs-app"
   git 'https://github.com/Lovalaunice/nodejs-application.git'
 }
 Stage('UnitTest'){
 sh "echo creating unitTest artifacts"
 //sh "npm test"
 }
 stage("Build"){
 sh "echo creating build artifacts"
 //nodejs(nodeJSInstallationName: 'nodejs16') {
        //sh "npm install"
    } 
  stage('Quality') {
  sh "echo CodeQualityReport"
     nodejs(nodeJSInstallationName: 'nodejs16.0.0') {
        sh 'npm run sonar'
    }
    }
      
        } 
		
    stage('UploadintoNexus') {
       nodejs(nodeJSInstallationName: 'nodejs15.2.1') {
          sh 'npm publish'
      }
      
          }	
 
 stage('RunNodeJsApp')
 {
 //sh "./scripts/run.sh"
 nodejs(nodeJSInstallationName: 'nodejs15.2.1') {
        sh 'npm start &'
    }
}    
    
}
